<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SpeedStar Typing Test</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: monospace;
      background: #000;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      flex-direction: column;
    }

    #container {
      width: 80%;
      max-width: 900px;
      text-align: center;
    }

    #stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      font-size: 18px;
    }

    #text {
      font-size: 28px;
      line-height: 2;
      text-align: left;
      margin-bottom: 20px;
      min-height: 120px;
    }

    .char {
      color: #666; /* default grey */
    }
    .char.correct {
      color: #fff; /* correct */
    }
    .char.incorrect {
      color: #ff3333; /* red for mistakes */
    }

    #input {
      opacity: 0;
      position: absolute;
      left: -9999px;
    }

    #result {
      display: none;
      font-size: 24px;
      margin-top: 40px;
      text-align: center;
    }

    button {
      margin-top: 20px;
      background: #111;
      color: #fff;
      border: 1px solid #444;
      padding: 10px 20px;
      cursor: pointer;
    }
    button:hover {
      background: #222;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="stats">
      <div>Time: <span id="timer">60</span>s</div>
      <div>WPM: <span id="wpm">0</span></div>
    </div>

    <div id="text"></div>
    <input type="text" id="input" autofocus />

    <div id="result">
      <h2>Results</h2>
      <p>WPM: <span id="finalWpm"></span></p>
      <p>Accuracy: <span id="accuracy"></span>%</p>
      <button onclick="resetTest()">Try Again</button>
    </div>
  </div>

  <script>
    const paragraphs = [
      "The quick brown fox jumps over the lazy dog.",
      "Typing fast requires focus and consistent practice every day.",
      "Dark themed apps are easy on the eyes and look super clean.",
      "Speed typing tests measure words per minute and accuracy.",
      "Monkeys love typing bananas on monkeytype dot com."
    ];

    const textEl = document.getElementById("text");
    const inputEl = document.getElementById("input");
    const timerEl = document.getElementById("timer");
    const wpmEl = document.getElementById("wpm");
    const resultEl = document.getElementById("result");
    const finalWpmEl = document.getElementById("finalWpm");
    const accuracyEl = document.getElementById("accuracy");

    let time = 60;
    let timer = null;
    let started = false;
    let currentText = "";
    let correctChars = 0;
    let totalTyped = 0;

    function loadParagraph() {
      currentText = paragraphs[Math.floor(Math.random() * paragraphs.length)];
      textEl.innerHTML = "";
      currentText.split("").forEach(c => {
        const span = document.createElement("span");
        span.innerText = c;
        span.classList.add("char");
        textEl.appendChild(span);
      });
    }

    function startTimer() {
      timer = setInterval(() => {
        time--;
        timerEl.textContent = time;
        if (time <= 0) {
          clearInterval(timer);
          endTest();
        }
      }, 1000);
    }

    inputEl.addEventListener("input", () => {
      if (!started) {
        started = true;
        startTimer();
      }

      const chars = document.querySelectorAll(".char");
      const typed = inputEl.value.split("");
      totalTyped++;

      chars.forEach((charSpan, i) => {
        if (typed[i] == null) {
          charSpan.classList.remove("correct", "incorrect");
        } else if (typed[i] === charSpan.innerText) {
          charSpan.classList.add("correct");
          charSpan.classList.remove("incorrect");
        } else {
          charSpan.classList.add("incorrect");
          charSpan.classList.remove("correct");
        }
      });

      if (typed.length === currentText.length && time > 0) {
        correctChars += typed.filter((c, i) => c === currentText[i]).length;
        inputEl.value = "";
        loadParagraph();
      }

      updateWPM();
    });

    function updateWPM() {
      let minutes = (60 - time) / 60;
      let words = correctChars / 5;
      let wpm = minutes > 0 ? Math.round(words / minutes) : 0;
      wpmEl.textContent = wpm;
    }

    function endTest() {
      inputEl.disabled = true;
      textEl.style.display = "none";
      resultEl.style.display = "block";

      let minutes = (60 - time) / 60;
      let words = correctChars / 5;
      let wpm = minutes > 0 ? Math.round(words / minutes) : 0;
      let accuracy = totalTyped > 0 ? Math.round((correctChars / totalTyped) * 100) : 0;

      finalWpmEl.textContent = wpm;
      accuracyEl.textContent = accuracy;
    }

    function resetTest() {
      time = 60;
      timerEl.textContent = time;
      inputEl.value = "";
      inputEl.disabled = false;
      started = false;
      correctChars = 0;
      totalTyped = 0;
      textEl.style.display = "block";
      resultEl.style.display = "none";
      loadParagraph();
      inputEl.focus();
    }

    // init
    loadParagraph();
    inputEl.focus();
  </script>
</body>
</html>
